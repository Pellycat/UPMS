"use strict";!function a(n,i,r){function s(t,e){if(!i[t]){if(!n[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(d)return d(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}o=i[t]={exports:{}},n[t][0].call(o.exports,function(e){return s(n[t][1][e]||e)},o,o.exports,a,n,i,r)}return i[t].exports}for(var d="function"==typeof require&&require,e=0;e<r.length;e++)s(r[e]);return s}({1:[function(e,t,o){t.exports='<div class="backtotop__record"><div class="backtotop__record-head clear"><div class="backtotop__record-head__running backtotop__record-head__tab js-record-tab {{#runningShow}}active{{/runningShow}} " href="#running"> 进行中</div><div class="backtotop__record-head__done backtotop__record-head__tab {{#doneShow}}active{{/doneShow}}"><a href="/algorithm/backtest/all" target="_blank" style="height:auto; color: inherit;">已完成</a></div><div class="backtotop__record-head__close"></div></div><div class="backtotop__record-body"><div id="running" class="backtotop__record-body__running {{#runningShow}}active{{/runningShow}} js-record"><ul> {{#running}}<li class="clear running__li"><div class="running__left backtotop__body-left"><div class="backtotop__body-name-container clear"> <span class="backtotop__body-type {{typeClass}} huice">{{typeName}}</span><div class="backtotop__body-name-row"><p> <a href="{{href}}" class="backtotop__body-name">{{name}}</a> <span class="backtotop__body-run-used-time">{{usedSec}}</span></p></div><span class="backtotop__body-runningCircle"></span></div></div><div class="running__right backtotop__body-right {{statusClass}}" data-type={{typeId}} data-id={{id}}></div></li> {{/running}} {{^running}}<li class="no-data">没有发现项目～</li> {{/running}}</ul></div><div id="done" class="backtotop__record-body__done {{#doneShow}}active{{/doneShow}} js-record"><ul> {{#done}}<li class="clear"><div class="done__left backtotop__body-left"><div class="backtotop__body-name-container clear"> <span class="backtotop__body-type {{typeClass}}">{{typeName}}</span><div class="backtotop__body-name-row"><p> <a href="{{href}}" class="backtotop__body-name">{{name}}</a> <span class="backtotop__body-run-used-time">{{usedSec}}</span></p></div></div></div><div class="done__right backtotop__body-right {{statusClass}}"></div></li> {{/done}} {{^done}}<li class="no-data">没有发现项目～</li> {{/done}}</ul></div></div><p class="backtotop__record-footer {{#isOver}}is-over{{/isOver}}"> 今日回测时长：{{duration.used}}/{{duration.free}}分钟 <a href="/view/vip/charge" target="_blank">延长免费回测时间</a></p></div>'},{}],2:[function(e,t,o){t.exports='<li class="qiyukf__entry backtotop-popover {{#qiyukfHidden}}hidden{{/qiyukfHidden}}"><div class="popover-content" style="width: 85px;margin-left: -95px;margin-top: 5px;">在线客服</div></li><li class="backtotop__progress {{#hidden}}hidden{{/hidden}}"><span class="backtotop__progress-count hidden"></span><div class="backtotop__record-container hidden"></div></li><li class="newUser backtotop__newUser hidden backtotop__scroll"><a href="/post/24debe6786302edc2febfc09b1312a6c" target="_blank"></a></li><li class="toTop backtotop__toTop hidden backtotop__scroll" id="top_btn"></li>'},{}],3:[function(O,e,t){e.exports=function(a,e){function n(){if(_.isLogin&&!r){if(!_.currentHtml||_.hideProgress)return!1;c.promise(g.statistics).done(function(e){var t,o=e.data,e=o.duration;for(t in o.running.length?d.find(".backtotop__progress-count").removeClass("hidden").html(o.running.length):d.find(".backtotop__progress-count").addClass("hidden").html(""),o.runningShow=_.runningShow,o.doneShow=_.doneShow,o.isOver=e.used>e.free,o.running=o.running,o)o[t].length&&o[t].map(function(e,t){"0"===e.type?(e.typeId="backtestId",e.typeName="回测",e.typeClass="huice",e.href=g.url.backtest+e.id):"1"===e.type?(e.typeName="归因",e.typeClass="guiyin",e.typeId="analyBacktestId",e.href=g.url.guiyin+e.id):"2"===e.type&&(e.typeId="factorAnalyId",e.typeName="因子",e.typeClass="yinzi",e.href=g.url.yinzi+e.id),"2"===e.status?(e.statusClass="success",e.progressbarClass="progress-bar-success"):"3"===e.status||"4"===e.status?(e.statusClass="fail",e.progressbarClass="progress-bar-danger"):(e.progressbarClass="progress-bar-success",e.statusClass="cancel")});k(),l(d.find(".backtotop__record-container"),h,o),w()})}_.currentHtml&&(_.stopInitRecord?_.initRecordTime=setTimeout(n,1e4):_.initRecordTime=setTimeout(n,3e4))}function t(){["/algorithm/index/edit","/factor/factor/edit","/view/algorithm/fundraising","/algorithm/backtest/summary","/default/research/detail","/help/data/tableList","/help/data/dataTree"].forEach(function(e){-1!==a.location.href.indexOf(e)&&(_.qiyukfHidden=!0)})}function o(){["/algorithm/backtest/summary","/default/research/detail","/algorithm/index/edit","/algorithm/factor/edit","algorithm/live/liveUrlShareIndex","/help/data/dataTree","/help/data/tableList"].map(function(e,t){0<=a.location.href.indexOf(e)&&(_.hideProgress=!0)}),["/algorithm/backtest/summary","/default/research/detail"].map(function(e,t){0<=a.location.href.indexOf(e)&&(_.iframeMessage=!0)}),_.isLogin&&!_.hideProgress||(_.hidden=!0),_.isLogin&&!_.iframeMessage||(_.iframeHidden=!0)}function i(){_.isLogin&&c.promise(g.getMessage).done(function(e){var t,o;_.iframeHidden||(e.data&&(t=parseInt(e.data.credits.amount)<0?"cut-amount":"add-amount",o=parseInt(e.data.credits.amount)<0?e.data.credits.amount:"+"+e.data.credits.amount,s("#leftsead > ul").prepend('<li class="leftsead-message"> <div>'+e.data.credits.message+' 积分<span class="'+t+'">'+o+"</span></div> </li>")),setTimeout(function(){s("#leftsead").find(".leftsead-message").remove()},2e3))})}var r=O("@util/routeParam.component")().isMobile(),s=O("jquery"),d=(r||(a=a||window),s(e)),c=O("@util/http.component")(),l=O("@util/render.component")(),u=O("@component/dialog/dialog.component"),p=O("mustache"),f=O("./index.component.html"),h=O("./asset/tpl/operation.record.html"),_={cdnPath:s(".js-cdn-path").val(),isLogin:!1,runningShow:!0,doneShow:!1,stopInitRecord:!1,currentHtml:!0,hideProgress:!1},g={statistics:"/algorithm/index/statistics",backtestId:"/algorithm/index/cancel",analyBacktestId:"/algorithm/backtest/analyCancel",factorAnalyId:"/algorithm/factorAnaly/cancel",url:{backtest:"/algorithm/backtest/detail?backtestId=",guiyin:"/algorithm/backtest/attributionAnaly?backtestId=",yinzi:"/algorithm/factorAnaly/detail?factorAnalyId="},getMessage:"/credits/index/getMessage"},m=function(){var e="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"mozHidden"in document?"mozHidden":null,t=e.replace(/hidden/i,"visibilitychange");_.hiddenProperty=e,_.visibilityChangeEvent=t},b=function(){document[_.hiddenProperty]?_.currentHtml=!1:(_.currentHtml=!0,n())},y=function(){_.isLogin=window.loginStatus,t(),o(),f=p.render(f,_),d.find("#leftsead ul").prepend(f),n(),C(),i()},v=function(o){a.location.href.indexOf(["/algorithm/backtest/summary","/default/research/detail"])<0&&s.ajax({url:"/community/post/userInfo",success:function(e){var t=(e=JSON.parse(e)).data;"00000"===e.code&&(Array.isArray(e.data)||(_.isLogin=!0,window.loginStatus=!0),o)&&"function"==typeof o&&o(t)},error:function(e){}})},k=function(){_.scrollT=s(".backtotop__record-body").scrollTop()},w=function(){s(".backtotop__record-body").scrollTop(_.scrollT)},C=function(){var e=s(a).scrollTop();r?s("#leftsead").addClass("hidden"):200<=e?s("#leftsead").find(".backtotop__scroll").removeClass("hidden"):s("#leftsead").find(".backtotop__scroll").addClass("hidden")},x=function(e){e=e||a.event;e=s(e.target);(e.hasClass("backtotop__progress")||e.hasClass("backtotop__record-head__close"))&&(s(".backtotop__record-container").toggleClass("hidden"),_.stopInitRecord=!_.stopInitRecord,clearTimeout(_.initRecordTime),n())},S=function(e){e=e||a.event;e=s(e.target);e.hasClass("backtotop__progress")||e.parents(".backtotop__progress").get(0)||s(".backtotop__record-container").hasClass("hidden")||(s(".backtotop__record-container").addClass("hidden"),_.stopInitRecord=!_.stopInitRecord,clearTimeout(_.initRecordTime),n())},T=function(){var e=s(".js-record-tab"),t=s(".js-record"),o=s(this),a=s(o.attr("href"));e.removeClass("active"),t.removeClass("active"),o.addClass("active"),a.addClass("active"),"#done"===o.attr("href")?(_.doneShow=!0,_.runningShow=!1):(_.doneShow=!1,_.runningShow=!0)},I=function(){var e=s(this),t=e.attr("data-type"),o=e.attr("data-id"),a={};if(a[t]=o,e.hasClass("disabled"))return!1;e.addClass("disabled"),c.promise(g[t],a,"POST").done(function(e){clearTimeout(_.initRecordTime),n()},function(e){u().createDialog({title:"提示",dialogCss:"backtotop__dialog",domHtml:e.msg,submitBtnText:"确定",cancelBtnCss:"hidden"})})},H=function(){"off"!=scroll&&s("html, body").animate({scrollTop:0},300)},q=function(){v(function(e){if(!a.ysf)return BootstrapDialog.alert("打开客服对话框失败，请刷新页面后重试");e.uniqueKey?a.ysf("config",{uid:e.uniqueKey,name:e.alias||"",level:e.level||0,success:function(){s.get("/vip/index/setLabel"),a.ysf("open")},error:function(e){a.ysf("open")}}):a.ysf("open")})};return{init:function(){!function(){if(-1!==window.location.href.indexOf("newwinapp"))return;m(),v(y)}(),d.delegate(".backtotop__progress","click",x),d.delegate(".kk_body","click",S),d.delegate(".js-record-tab","click",T),d.delegate(".running__right.cancel","click",I),d.delegate("#top_btn","click",H),d.delegate(".qiyukf__entry","click",q),s(a).scroll(C),document.addEventListener(_.visibilityChangeEvent,b)}}}},{"./asset/tpl/operation.record.html":1,"./index.component.html":2,"@component/dialog/dialog.component":void 0,"@util/http.component":void 0,"@util/render.component":void 0,"@util/routeParam.component":void 0,jquery:"jquery",mustache:"mustache"}],4:[function(e,t,o){e("./index.component")(window,document.body).init()},{"./index.component":3}]},{},[4]);